<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>LED Backpack Text Animator</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="topbar">
    <h1>‚ö° LED Backpack Text Animator</h1>
  </header>

  <main class="layout">
    <aside id="aboutPanel" class="panel side">
      <h2>About & Config</h2>
      <p class="dim">Design animated text GIFs for LED backpacks. Mobile-friendly live preview, edit on-canvas, export GIF.</p>

      <div class="stack">
        <label class="btn block">
          Upload Preset (JSON)
          <input id="uploadPresetInput" type="file" accept="application/json" hidden />
        </label>
        <button id="downloadPresetBtn" class="btn block">Download Current Preset (JSON)</button>
        <button id="exportBundleBtn" class="btn ghost block">Export Bundle (.zip)</button>
      </div>

      <div class="row" style="margin-top:12px">
        <label class="pill">
          <input type="checkbox" id="helpToggle">
          Show help overlay
        </label>
      </div>

      <hr>

      <details>
        <summary>Credits & License</summary>
        <p>Created by <a href="https://instagram.com/theskylincoln" target="_blank" rel="noopener">@theskylincoln</a>. Built with ChatGPT.</p>
        <p>MIT License.</p>
      </details>

      <hr>
      <label for="ownerKey" class="dim">Owner key (private)</label>
      <input id="ownerKey" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
    </aside>

    <section class="panel main">
      <section class="panel inner">
        <h2>Background & Resolution</h2>

        <div class="row">
          <label>Resolution</label>
          <select id="resolutionSel">
            <option>96√ó128</option>
            <option>64√ó64</option>
            <option>Custom</option>
          </select>
          <div id="customRes" class="row" style="display:none; gap:8px; margin-left:12px;">
            <label>W</label><input id="customW" type="number" min="8" max="512" value="96">
            <label>H</label><input id="customH" type="number" min="8" max="512" value="128">
          </div>
        </div>

        <div class="row" style="align-items:flex-start;">
          <div>
            <div class="row" style="gap:8px; margin-bottom:8px;">
              <label class="pill"><input type="radio" name="bgsrc" value="Preset" checked> Preset</label>
              <label class="pill"><input type="radio" name="bgsrc" value="Solid"> Solid</label>
              <label class="pill"><input type="radio" name="bgsrc" value="Custom"> Custom</label>
            </div>
            <div id="bgPresetGrid" class="thumbGrid"></div>
            <input id="solidColor" type="color" value="#000000" style="display:none;">
            <input id="customBgInput" type="file" accept=".png,.jpg,.jpeg,.gif" style="display:none;">
          </div>
        </div>
      </section>

      <section class="panel inner">
        <h2>Live Preview</h2>

        <div class="row" style="gap:8px; align-items:center;">
          <button id="playPauseBtn" class="btn">‚è∏ Pause</button>
          <label class="pill"><input id="editModeToggle" type="checkbox"> Edit mode</label>
          <div class="row" style="gap:4px; margin-left:auto;">
            <button id="zoomOutBtn" class="btn ghost">‚àí</button>
            <button id="zoomFitBtn" class="btn ghost">Fit</button>
            <button id="zoomInBtn" class="btn ghost">+</button>
          </div>
        </div>

        <div id="previewWrap">
          <canvas id="previewCanvas" width="96" height="128"></canvas>
          <div id="helpOverlay" class="help" hidden>
            <h3>How to use</h3>
            <ol>
              <li>Choose a background & resolution.</li>
              <li>Toggle <strong>Edit mode</strong> to pause and edit.</li>
              <li>Tap a word to edit, drag to move, use toolbar to style.</li>
              <li>Toggle Edit OFF to resume smooth animation.</li>
            </ol>
          </div>
          <div id="inspector" class="inspector" hidden>
            <div class="ins-head">
              <span id="insLabel">Word</span>
              <button id="insDone" class="btn ghost small">Done</button>
            </div>
            <div class="ins-body">
              <input id="insText" type="text" placeholder="TEXT">
              <div class="row">
                <label class="dim">Color</label>
                <input id="insColor" type="color" value="#ffffff">
              </div>
              <div class="row">
                <label class="dim">Size</label>
                <input id="insSize" type="range" min="8" max="200" value="24">
              </div>
              <div class="row">
                <button id="nudgeL" class="btn ghost small">‚Üê</button>
                <button id="nudgeU" class="btn ghost small">‚Üë</button>
                <button id="nudgeD" class="btn ghost small">‚Üì</button>
                <button id="nudgeR" class="btn ghost small">‚Üí</button>
                <button id="deleteWordBtn" class="btn danger small" style="margin-left:auto;">üóë Delete</button>
              </div>
            </div>
          </div>
        </div>

        <div class="row" style="gap:8px; margin-top:10px;">
          <button id="addLineBtn" class="btn">‚ûï Add Line</button>
          <button id="addWordBtn" class="btn ghost">+ Word (selected line)</button>
        </div>
      </section>

      <section class="panel inner">
        <details>
          <summary><strong>Typography</strong></summary>
          <div class="row">
            <label>Auto size</label>
            <input id="autoSizeToggle" type="checkbox" checked>
            <label>Line gap (px)</label>
            <input id="lineGap" type="number" min="0" max="20" value="2">
            <label>Word spacing (px)</label>
            <input id="wordSpace" type="number" min="0" max="20" value="3">
          </div>
        </details>
        <details>
          <summary><strong>Animation</strong></summary>
          <div class="row">
            <label>Enable anim</label><input id="animEnable" type="checkbox" checked>
            <label>Breath Y</label><input id="animBY" type="number" step="0.1" value="4.0">
            <label>Scale</label><input id="animSC" type="number" step="0.01" value="0.03">
            <label>Breath Cycles</label><input id="animBC" type="number" step="0.1" value="1.0">
          </div>
          <div class="row">
            <label>Wave X</label><input id="animWX" type="number" step="0.1" value="0.8">
            <label>Wave Y</label><input id="animWY" type="number" step="0.1" value="1.4">
            <label>Wave Cycles</label><input id="animWC" type="number" step="0.1" value="1.0">
          </div>
          <div class="row">
            <label>Jitter</label><input id="animJJ" type="number" step="0.01" value="0.10">
            <label>Jitter Cycles</label><input id="animJC" type="number" step="0.1" value="2.5">
          </div>
        </details>
        <details>
          <summary><strong>Output</strong></summary>
          <div class="row">
            <label>Seconds</label><input id="seconds" type="number" min="1" max="30" value="8">
            <label>FPS</label><input id="fps" type="number" min="1" max="30" value="15">
            <label>Auto-match BG FPS</label><input id="autoMatch" type="checkbox" checked>
          </div>
          <details id="advGifBlock">
            <summary>Advanced GIF compression</summary>
            <div class="row">
              <label>Palette</label><input id="gifPalette" type="range" min="16" max="256" step="16" value="128">
              <span id="gifPaletteVal">128</span>
              <label>Dither</label>
              <select id="gifDither">
                <option value="none">None</option>
                <option value="bayer">Bayer</option>
                <option value="floydsteinberg" selected>Floyd‚ÄìSteinberg</option>
              </select>
              <label>Per-frame diff</label><input id="gifDiff" type="checkbox" checked>
            </div>
          </details>
          <div class="row" style="margin-top:10px;">
            <button id="renderBtn" class="btn">Render & Download GIF</button>
          </div>
        </details>
      </section>
    </section>
  </main>

  <script src="https://unpkg.com/jszip@3.10.1/dist/jszip.min.js"></script>
  <script src="https://unpkg.com/gifenc@1.0.3/dist/gifenc.umd.js"></script>
  <script src="app.js"></script>
</body>
</html>
