<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0b0f12">
  <link rel="manifest" href="static/manifest.webmanifest">
  <link rel="apple-touch-icon" href="static/icon-192.png">
  <title>LED Backpack Text Animator</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Client-side GIF encoder -->
  <script src="https://cdn.jsdelivr.net/npm/gif-encoder-2/browser/gif-encoder-2.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@700&display=swap" rel="stylesheet">
</head>
<body>
<header>
  <h1>‚ö° LED Backpack Text Animator</h1>
  <p class="sub">Create animated text GIFs for LED backpacks ‚Äî fully client-side. Mobile-optimized.</p>
</header>

<main id="app">
  <aside id="about">
    <details open>
      <summary>About & Config Download/Upload</summary>
      <p>Developed with the assistance of ChatGPT ‚Ä¢ Follow <a href="https://instagram.com/theskylincoln" target="_blank" rel="noopener">@theskylincoln</a> ‚Äî bringing theskylincoln‚Äôs LED Backpack idea to life ‚ö°</p>
      <div class="owner">
        <label>Owner Key</label>
        <input type="password" id="ownerKey" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        <button id="ownerApply">Apply</button>
        <div id="ownerActions" class="hidden">
          <button id="loadOwnerA">Owner A ‚Äî Wheelie 96√ó128</button>
          <button id="loadOwnerB">Owner B ‚Äî 2 Up 96√ó128</button>
        </div>
      </div>
      <div class="cfg io">
        <button id="downloadJson">‚¨áÔ∏è Download preset (JSON)</button>
        <label class="file">
          Upload preset (JSON)
          <input type="file" id="uploadJson" accept=".json,application/json">
        </label>
      </div>
    </details>
  </aside>

  <section id="controls">
    <div class="panel">
      <details open>
        <summary>Background & Resolution</summary>
        <div class="row">
          <label>Resolution</label>
          <select id="resMode">
            <option value="96x128">96√ó128</option>
            <option value="64x64">64√ó64</option>
            <option value="Custom">Custom‚Ä¶</option>
          </select>
          <div id="customWH" class="row hidden">
            <label>W <input type="number" id="W" min="8" max="512" value="96"></label>
            <label>H <input type="number" id="H" min="8" max="512" value="128"></label>
          </div>
        </div>

        <div class="row">
          <label>Background</label>
          <div class="tabs">
            <button class="tab active" data-tab="Preset">Preset</button>
            <button class="tab" data-tab="Solid">Solid Color</button>
            <button class="tab" data-tab="Custom">Upload</button>
          </div>
        </div>

        <div id="bgPreset" class="thumbs"></div>
        <div id="bgSolid" class="row hidden">
          <input type="color" id="solidHex" value="#000000">
        </div>
        <div id="bgCustom" class="row hidden">
          <input type="file" id="customBg" accept="image/*">
        </div>

        <div class="row">
          <label><input type="checkbox" id="autoMatch" checked> Auto-match animated background FPS (cap 30)</label>
        </div>
      </details>

      <details open>
        <summary>Editor & Preview</summary>
        <div class="row between">
          <div class="row">
            <label class="switch">Live Preview
              <input type="checkbox" id="liveToggle" checked>
            </label>
            <label class="switch">Performance
              <select id="perfMode">
                <option value="smooth">Smooth</option>
                <option value="battery">Battery Saver</option>
              </select>
            </label>
          </div>
          <div class="row">
            <button id="addLine">‚ûï Add line</button>
            <button id="resetAuto">‚Ü∫ Reset auto layout</button>
            <button id="clearText">üßπ Clear text</button>
            <button id="centerAll">üéØ Center all</button>
          </div>
        </div>

        <div id="canvasWrap">
          <canvas id="preview" width="192" height="256"></canvas>
        </div>

        <div id="inspector" class="hidden">
          <h4>Selected Word</h4>
          <div class="row">
            <label>Text <input type="text" id="wordText"></label>
          </div>
          <div class="row">
            <label>Color
              <select id="wordColor"></select>
            </label>
            <label>Size √ó
              <input type="number" id="wordScale" min="0.3" max="4" step="0.1">
            </label>
          </div>
          <div class="row">
            <button id="addWord">+ Word</button>
            <button id="delWord">Delete Word</button>
            <button id="delLine">Delete Line</button>
            <button id="centerWord">Center Word</button>
          </div>
          <div class="row">
            <label>Line Align</label>
            <button id="alignLeftLine">‚ü∏ Left</button>
            <button id="alignCenterLine">‚Üî Center</button>
            <button id="alignRightLine">Right ‚üπ</button>
          </div>
          <div class="row advanced-only">
            <div class="nudge-pad">
              <button id="nudgeUp">‚Üë</button>
              <div class="hbox">
                <button id="nudgeLeft">‚Üê</button>
                <button id="nudgeDown">‚Üì</button>
                <button id="nudgeRight">‚Üí</button>
              </div>
            </div>
            </div>
            <div id="fineCrosshair" class="fine-crosshair advanced-only" title="Drag inside to fine-nudge"></div>
            <div class="hbox" style="margin-top:6px">
              <label class="switch"><input type="checkbox" id="lockX"><span class="slider"></span></label>
              <span style="margin-left:6px;margin-right:12px;">Lock X</span>
              <label class="switch"><input type="checkbox" id="lockY"><span class="slider"></span></label>
              <span style="margin-left:6px;">Lock Y</span>
            </div>
            <button id="snapBaseline" style="margin-left:12px">Snap to baseline</button>
          </div>
          <div class="row">
            <label>Spacing Mode
              <select id="spacingModeLine">
                <option value="natural">Natural</option>
                <option value="equal">Equal (justify)</option>
                <option value="equalNoOuter">Equal (no outer)</option>
              </select>
            </label>
            <button id="applyEqualAll">Equal spacing for all</button>
          </div>
        </div>
      </details>

      <details>
        <summary>Typography</summary>
        <div class="row">
          <label>Text size
            <select id="sizeMode">
              <option value="Auto">Auto</option>
              <option value="Manual">Manual</option>
            </select>
          </label>
          <label id="manualSizeWrap" class="hidden">Manual size
            <input type="number" id="manualSize" min="8" max="200" value="24">
          </label>
        </div>
        <div class="row">
          <label>Line gap (px) <input type="number" id="lineGap" min="0" max="20" value="2"></label>
          <label>Word spacing (px) <input type="number" id="wordSpacing" min="0" max="20" value="3"></label>
          <label>Gutter (px) <input type="number" id="gutterPx" min="0" max="20" value="2"></label>
        </div>
      </details>

      <details>
        <summary>Animation</summary>
        <label><input type="checkbox" id="animEnabled" checked> Enable animation</label>
        <div class="grid3">
          <label>Breath Y <input type="number" id="animBY" step="0.1" value="4.0"></label>
          <label>Scale Ampl <input type="number" id="animSC" step="0.01" value="0.03"></label>
          <label>Breath Cycles <input type="number" id="animBC" step="0.1" value="1.0"></label>
          <label>Wave X <input type="number" id="animWX" step="0.1" value="0.8"></label>
          <label>Wave Y <input type="number" id="animWY" step="0.1" value="1.4"></label>
          <label>Wave Cycles <input type="number" id="animWC" step="0.1" value="1.0"></label>
          <label>Jitter Ampl <input type="number" id="animJJ" step="0.01" value="0.10"></label>
          <label>Jitter Cycles <input type="number" id="animJC" step="0.1" value="2.5"></label>
        </div>
      </details>

      <details open>
        <summary>Output</summary>
        <div class="grid3">
          <label>Seconds <input type="number" id="seconds" min="1" max="30" value="8"></label>
          <label>FPS <input type="number" id="fps" min="1" max="30" value="15"></label>
          <label>Output Name <input type="text" id="outName" value="led"></label>
        </div>
        <div class="row">
          <button id="renderGif">Render & Download GIF</button>
          <a id="dlLink" class="hidden" download>‚¨áÔ∏è Download GIF</a>
        </div>
      </details>
    </div>
  </section>
</main>

<footer>
  <small>¬© 2025 theskylincoln ‚Äî with assistance from ChatGPT</small>
</footer>

<script src="app.js"></script>

<div id="helpOverlay" class="help-overlay hidden">
  <div class="help-card">
    <h2>How to use</h2>
    <ul>
      <li><b>Tap</b> a word to select it. <b>Drag</b> to move.</li>
      <li><b>Long-press</b> to open the inspector (or use the button).</li>
      <li><b>+ Word</b> adds a word to the selected line. <b>Add line</b> creates a new centered line.</li>
      <li>Use the <b>arrow keys</b> to nudge the selected word (hold Shift for 5px).</li>
      <li>Use <b>Undo ‚éå</b> / <b>Redo ‚§º</b> for history.</li>
      <li>Switch to <b>Exact preview</b> to match the final GIF framerate.</li>
    </ul>
    <button id="closeHelp">Got it</button>
  </div>
</div>
</body>

</html>
